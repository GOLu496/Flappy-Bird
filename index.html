<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Flappy Bird Red with Ground Line</title>
<style>
    body {
        margin: 0;
        background: #70c5ce;
        overflow: hidden;
        font-family: Arial, sans-serif;
    }
    #gameCanvas {
        display: block;
        margin: 0 auto;
        background: #70c5ce;
    }
    #scoreBoard {
        position: fixed;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 24px;
        color: white;
        text-shadow: 2px 2px 4px #000;
        z-index: 10;
    }
    #ad-container {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        text-align: center;
        background: #fff;
        padding: 5px;
        border-top: 1px solid #ccc;
        z-index: 10;
    }
</style>
</head>
<body>

<div id="scoreBoard">Score: 0</div>
<canvas id="gameCanvas" width="320" height="480"></canvas>

<div id="ad-container">
    <!-- Replace with your real AdSense code after approval -->
    <p style="font-size:14px;color:#333;">[Ad Banner Here]</p>
</div>

<script>
// ===== GAME VARIABLES =====
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
let frames = 0;
let score = sessionStorage.getItem("flappyScore") ? parseInt(sessionStorage.getItem("flappyScore")) : 0;
const gravity = 0.25;
const jump = 4.6;
let pipes = [];
const pipeGap = 85;
const pipeWidth = 53;
let gameSpeed = 2;
const groundY = canvas.height - 60; // Red line position

// ===== GAME STATE =====
let state = 0; // 0 = ready, 1 = playing, 2 = over

// ===== BIRD =====
let bird = {
    x: 50,
    y: 150,
    radius: 12,
    speed: 0,
    draw: function(){
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.radius, 0, Math.PI*2);
        ctx.fillStyle = "red";
        ctx.fill();
        ctx.closePath();
    },
    flap: function(){
        this.speed = -jump;
    },
    update: function(){
        this.speed += gravity;
        this.y += this.speed;

        // Red line collision
        if(this.y + this.radius >= groundY){
            this.y = groundY - this.radius;
            state = 2; // Game over
        }
    }
};

// ===== PIPE LOGIC =====
function spawnPipe(){
    let yPos = -150 * (Math.random() + 1);
    pipes.push({ x: canvas.width, y: yPos });
}
function drawPipes(){
    ctx.fillStyle = "green";
    pipes.forEach(p => {
        ctx.fillRect(p.x, p.y, pipeWidth, 400); // top
        ctx.fillRect(p.x, p.y + 400 + pipeGap, pipeWidth, 400); // bottom
    });
}
function updatePipes(){
    pipes.forEach((p, i) => {
        p.x -= gameSpeed;

        // Collision check
        if (bird.x + bird.radius > p.x && bird.x - bird.radius < p.x + pipeWidth &&
            (bird.y - bird.radius < p.y + 400 || bird.y + bird.radius > p.y + 400 + pipeGap)) {
            state = 2;
        }

        // Remove off-screen pipes & add score
        if(p.x + pipeWidth <= 0){
            pipes.splice(i, 1);
            score++;
            sessionStorage.setItem("flappyScore", score);
        }
    });
}

// ===== DRAW GROUND LINE =====
function drawGround(){
    ctx.fillStyle = "red";
    ctx.fillRect(0, groundY, canvas.width, 5); // thin red line
}

// ===== GAME LOOP =====
function draw(){
    ctx.fillStyle = "#70c5ce";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    drawPipes();
    bird.draw();
    drawGround();
}

function update(){
    if(state === 1){
        bird.update();
        if(frames % 100 === 0) spawnPipe();
        updatePipes();
    }
}

function loop(){
    update();
    draw();
    document.getElementById("scoreBoard").innerText = "Score: " + score;
    frames++;
    requestAnimationFrame(loop);
}

// ===== CONTROL =====
canvas.addEventListener("click", function(){
    if(state === 0){ // Start game on first click
        state = 1;
        bird.flap();
    } else if(state === 1){ // Jump during game
        bird.flap();
    } else if(state === 2){ // Reset after game over
        state = 0;
        score = 0;
        sessionStorage.setItem("flappyScore", score)
            </script>
    
